The code consists of six modules: dataset, model, pattern, surrogate, shap, and representation. Below are the instructions to reproduce the results:

### Train the Black Box Model
To train the black box model, execute:
```
python modelmod/train_gnn.py {dataset_name}
```
To use a pretrained model, add the option `--pretrained`. The result will be saved in `{dataset_name} training results.txt`.

### Mine the Patterns
To mine the patterns, execute:
```
python patternmod/pattern_mining.py {dataset_name}
```

### Train the Surrogate Model
To train the surrogate model, execute:
```
python surrogatemod/traingin.py {dataset_name}
```
To evaluate random features instead of pattern activations, add the option `--random`. Results will be available in `models/{dataset_name}_inside_results.txt` and for random features in `models/random features/{dataset_name}_inside_results.txt`.

### Train the Surrogate Model with Simpler Models
To train the surrogate model with simpler models, execute:
```
python surrogatemod/simplempde/simple_script.py
```
Results will be available in `surrogatemod/simplemodle/results.txt`.

### Obtain the Shapley Values
To obtain the Shapley values, execute:
```
python shapmod/calculateshap.py {dataset_name}
```

### Evaluate Instance Level Explanation
To evaluate the performance of the method on the instance level explanation, execute:
```
python shapmod/rulemask.py {dataset_name}
```

### Obtain Graph Representations of the Rules
To obtain the graph representations of the rules, execute:
```
python representationmod/cluster_representation.py {dataset_name}
```
Results will be available in `representationmod/figs/{dataset_name}/{dataset_name}_final_{pattern_number}_gcn_patt_clusters.png`.

### Evaluate Explanations Generated by Baselines
To evaluate the explanations generated by baselines, execute:
```
python bseval/{method_name}.py {dataset_name}
```

### environment:
```
PYTHONPATH=:{parent directory of code}/shap_inside/codebase:{parent directory of code}/shape_inside/EdgeSHAPer/:{parent directory of code}/shape_inside/GStarX:{parent directory of code}/shap_inside/GraphXAI:{parent directory of code}/shap_inside/FGW/lib
```
### NOTE
Please rename the name of the code directory to "shap_inside"
Please extract the files of the large_files.zip into the corresponding directory marked in the large_files.txt
